<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <!--
      This Amos Professional Manual is written by asymetrix for the Amiga community and should stay completly FREE FOREVER.
      Created 2008. :)
  -->
  <title>Amos Professional Manual - Machine Code</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="keywords" content="Amos Professional, Amiga, Programming, Basic, Francois Lionet, Europress Software Ltd, Amos, computing, code, AmigaDOS">
  <meta name="author" content="asymetrix">

</head>

<body bgcolor="white">

<a href="../index.html">Amos Professional Manual</a>&nbsp; <a href="../contents/c1.html">Contents</a>&nbsp; <a href="../14/1446.html">Index</a>

<h1>Machine Code</h1>

<br>

<p>
The address of the string can now be established, and passed to the procedure. So providing
strings themselves are not used in the procedure, you should remain safe.</p>

<p>Another hazard can be encountered if you try to POKE values straight into a string.<br>
Try</p>

<pre>
E> A$="123456789": Rem Define a string of characters
   For C=0 To Len(A$)-1
    AD=Varptr(A$) : Rem Get the address
    V=Peek(AD+C) : Rem Get Ascii value of current element
    Poke AD+C,V+1 : Rem Add 1 to it
   Next C
   Print A$
</pre>

<p>
When you return to the Editor, you will discover that your listing has been changed!- AMOS
Professional is trying to save space by storing your string in the program listing, rather than the
standard variable "buffer". This problem can be solved by loading the first character into the
start of the string, then adding the remaining characters later. Here is how:</p>

<pre>
E> A$="1" : Rem Set up the first character
   A$=A$+"23456789" : Rem Now add remaining characters
</pre>

<p>This fools AMOS Professional into creating a separate copy of the string in the variable buffer.</p>

<p>
<b>Numerical arrays</b> are stored as a simple list of values, with each dimension stored in turn. Look
at the following array:</p>

<pre>
X> Dim TEST(3,3)
</pre>

<p>That array is held in the following order:</p>

<pre>
0,0 0,1 0,2 0,3
1,0 1,1 1,2 1,3
2,0 2,1 2,2 2,3
3,0 3,1 3,2 3,3
</pre>

<p>So to return the address of the first value of the array, you would use this:</p>

<pre>
X> Varptr TEST(0,0)
</pre>

<p>
<b>String arrays</b> are more complex, because their length needs to change whenever one of their
elements is assigned to a new value. The only way of ensuring total safety is to avoid them
altogether! If you ignore this advice and try to access them using VARPTR, you are risking real
danger.</p>

<div align="right"> <a href="1407.html">Back</a> &nbsp;&nbsp;
  <a href="1409.html">Next</a>
  <br>
  14.A.08
</div>

</BODY>
</HTML>
