<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <!--
      This Amos Professional Manual is written by asymetrix for the Amiga community and should stay completly FREE FOREVER.
      Created 2008. :)
  -->
  <title>Amos Professional Manual - Machine Code</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="keywords" content="Amos Professional, Amiga, Programming, Basic, Francois Lionet, Europress Software Ltd, Amos, computing, code, AmigaDOS">
  <meta name="author" content="asymetrix">

</head>

<body bgcolor="white">

<a href="../index.html">Amos Professional Manual</a>&nbsp; <a href="../contents/c1.html">Contents</a>&nbsp; <a href="../14/1446.html">Index</a>

<h1>Machine Code</h1>

<br>

<p>
As usual, the bit is specified by giving the number of its position, followed by either a variable or
expression. If the value is an expression, it is assumed to be an address, and great care should be
taken.</p>

<p><b>BCLR</b><br>
<i>instruction: clear a bit</i><br>
<b>Bclr</b> number,value</p>

<p>
The BCLR command clears a bit by setting it to zero. The bit number can be from 0 to 31, and
pinpoints the single binary digit to be cleared. If the value is an expression, it will be used as an
address in memory.</p>

<p><b>Using assembly language</b></p>

<p>
AMOS Professional exploits the most useful machine code routines and transforms them into
simple Basic commands. Even if you are an experienced machine code programmer, you will
have to work very hard to better the speed and range of AMOS Professional.</p>

<p>
Even though assembly language is hazardous and you are best advised to avoid it, there are a
few routines which could be improved by its use. So for this reason, you are provided with
several methods of accessing machine code directly from AMOS Professional Basic. These
features are strictly for experts, and should be ignored by anyone not familiar with assembly
language.</p>

<p><b>Machine code procedures</b><br>

The easiest option for exploiting assembly language is to install machine code directly into an
AMOS Professional procedure. These procedures can be saved and loaded using standard
commands, and then executed from the Basic program simply by typing their name! Apart from
the fact that it cannot be listed on screen, the only effective difference between a machine code
procedure and its Basic equivalent is speed.</p>

<p>
Machine code procedures are completely compatible with the AMOS Compiler, which will not
only run most of your programs at double speed, but also compact them to a fraction of their
original size. This means that if you decide to compile your programs at a later date, you will not
need to alter your assembly language at all. The following points should be noted before using
an assembler:</p>

<ul>
  <li>Routines should be re-locatable, able to run under CLI and should end with a simple RTS
      instruction.</li>
  <li>The only limit to the size of the machine code is the amount of available memory. However,
      only the <b>first</b> CODE segment should be used for programs. The contents of any other segment
      will be completely ignored!</li>
  <li>If memory is reserved using the Amiga system functions, remember to return reserved
      memory to the memory pool after use. AMOS Professional cannot be expected to know or
      care what you are doing!</li>
  <li>A procedure <b>will be moved</b> in memory every time a line is entered via the Editor. This means
      that if an interrupt is attached to the routine, it must be removed before anything in the Basic
      program is changed, otherwise the Amiga will crash!</li>
</ul>

<div align="right"> <a href="1410.html">Back</a> &nbsp;&nbsp;
  <a href="1412.html">Next</a>
  <br>
  14.A.11
</div>

</BODY>
</HTML>
