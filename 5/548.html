<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <!--
      This Amos Professional Manual is written by asymetrix for the Amiga community and should stay completly FREE FOREVER.
      Created 2008. :)
  -->
  <title>Amos Professional Manual - Procedures</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="keywords" content="Amos Professional, Amiga, Programming, Basic, Francois Lionet, Europress Software Ltd, Amos, computing, code, AmigaDOS">
  <meta name="author" content="asymetrix">

</head>

<body bgcolor="white">

<a href="../index.html">Amos Professional Manual</a>&nbsp; <a href="../contents/c1.html">Contents</a>&nbsp; <a href="../14/1446.html">Index</a> 

<h1>Procedures</h1>

<br>

<P>
used to mean "match this with any list of characters in the variable name, until the next 
control character is reached", and the ? character means "match this with any single character in 
the variable name". So the next line would define every variable as global:</P>

<pre>
X> Global "*"
</pre>

<P>Now look at the following example:</P>

<pre>
X> Shared A,"V*","VAR*END","A?0S*"
</pre>

<P>That line would declare the following variables as shared:</P>

<UL>
  <LI>A, as usual.</LI>

  <LI>Any variable beginning with the character V, followed by any other characters, or on 
  its own.</LI>

  <LI>Any variable beginning with the letters VAR, followed by any other characters, and 
  ending with the characters END.</LI>

  <LI>Any variable beginning with A, followed by any single letter, followed by OS, 
  followed by any other characters.</LI>
</UL>

<P>
GLOBAL or SHARED should be employed before the first use of the variable, otherwise it 
will have no effect on an interpreted program, although it will affect programs compiled with 
the AMOS Professional Compiler.</P>

<P>
Only strings may be used for this technique. Global and shared arrays cannot be defined 
using wild cards. These must be defined individually, using brackets. Also, if you try to use an
expression in this way, an error will be generated.<BR>
For example:</P>

<pre>
X> A$="AM*"
   Global A$
</pre>

<P>
In that case, the A$ variable would be regarded as global, and it would not be taken as 
a wild card for subsequent use.</P>

<P>With AMOS Professional, you are able to define global arrays from a procedure, even if 
the array
is not created at root level, as follows:</P>

<pre>
X> Procedure VARIABLES
   Dim ARRAY(100,100)
   Global ARRAY()
   End Proc
</pre>

<P><b>Returning values from a procedure</b><br>

If you want to return a parameter from inside a procedure, that is to say, if you need 
to send back a value from a local parameter, you need a way of telling your main program where to 
find this local variable.</P>


<div align="right"> <a href="547.html">Back</a> &nbsp;&nbsp;
  <a href="549.html">Next</a>
  <br>
  05.05.07
</div>

</BODY>
</HTML>
